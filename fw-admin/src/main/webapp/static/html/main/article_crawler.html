<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-sm-12">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">文章爬虫
                        <small></small>
                    </h3>
                </div>
                <!-- /.box-header -->
                <div class="box-body pad">
                    <div class="col-sm-6">
                        <select id="selCrawler" data-btn-class="btn-warning"></select>
                        <form id="form1" role="form">
                            <div class="form-group">
                                <label class="control-label" for="ssource">文章来源</label>
                                <input id="ssource" name="sSource" value="" class="form-control" type="text"
                                       placeholder="转载的URL">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="stitle">文章标题</label>
                                <input id="stitle" name="sTitle" value="" class="form-control" type="text"
                                       placeholder="标题">
                            </div>
                            <div class="form-group">
                                <label class="control-label">内容</label>
                                <input id="scontent" name="sContent" value="" class="form-control" type="text"
                                       placeholder="内容">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="ssummary">文章摘要</label>
                                <input id="ssummary" name="sSummary" value="" class="form-control" type="text"
                                       placeholder="摘要">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="ssmallImg">小图（列表页）</label>
                                <input id="ssmallImg" name="sSmallimg" value="" class="form-control" type="text"
                                       placeholder="小图">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="sbigImg">大图（文章头部）</label>
                                <input id="sbigImg" name="sBigimg" value="" class="form-control" type="text"
                                       placeholder="大图">
                            </div>
                            <div class="form-group text-center btn-area">
                                <a class="btn btn-warning getbtn" role="button"><i class="fa fa-save"></i>&nbsp;开始</a>&nbsp;&nbsp;&nbsp;
                            </div>
                        </form>
                    </div>
                    <!-- /.col-->
                    <div class="col-sm-6">
                        <form id="form2" role="form">
                            <div class="form-group">
                                <label class="control-label" for="title">文章标题</label>
                                <input id="title" name="title" value="" class="form-control" type="text"
                                       placeholder="标题">
                            </div>
                            <div class="form-group">
                                <label class="control-label">内容</label>
                                <textarea id="content2" name="content" class="form-control"
                                          style="width:100%;height:450px;"
                                          placeholder="在这里编辑"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="summary">文章摘要(默认提取文章的前200字作为摘要，你也可以在这里自行编辑)</label>
                                <textarea id="summary" name="summary" class="form-control" placeholder="摘要"
                                          rows="4"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="smallImg">小图（列表页）</label>
                                <input id="smallImg" name="smallImg" value="" class="form-control" type="text"
                                       placeholder="小图">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="bigImg">大图（文章头部）</label>
                                <input id="bigImg" name="bigImg" value="" class="form-control" type="text"
                                       placeholder="大图">
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="sourceLink">转载来源(原创文章可以忽略)</label>
                                <input id="sourceLink" name="sourceLink" value="" class="form-control" type="text"
                                       placeholder="转载的URL">
                            </div>
                        </form><!-- /#form -->
                    </div>
                    <!-- /.col-->
                </div>
            </div>
        </div>
        <!-- /.col-->

    </div>
    <!-- ./row -->
</section>
<!-- /.content -->
<script>
    $(function () {
        ComboboxHelper.build('/admin/main/getCrawlersWithBox.action','#selCrawler');
        $('.pad').on('change','#selCrawler', function() {
            var cid = ComboboxHelper.getSelected("#selCrawler");
            if(!cid){
                cid = $('#selCrawler').val();
            }
            $.ajax({
                type: 'post',
                url: '/admin/main/getCrawler.action',
                dataType: 'json',
                data: {id: cid},
                success: function (json) {
                    if (json.entity) {
                        $('#stitle').val(json.entity.sTitle);
                        $('#ssummary').val(json.entity.sSummary);
                        $('#scontent').val(json.entity.sContent);
                        $('#ssmallImg').val(json.entity.sSmallImg);
                        $('#sbigImg').val(json.entity.sBigImg);
                    } else {
                        alert("获取爬虫失败，错误码：" + json.result);
                    }
                }
            });
        });
        $('.getbtn').click(function () {
            $.ajax({
                type: 'post',
                url: '/admin/main/crawler.action',
                dataType: 'json',
                data: $('#form1').serializeArray(),
                success: function (json) {
                    if (json.result == 1) {
                        $('#title').val(json.data.title);
                        $('#summary').val(json.data.summary);
                        $('#content2').text(json.data.content);
                        $('#smallImg').val(json.data.smallImg);
                        $('#bigImg').val(json.data.bigImg);
                    } else {
                        alert("爬取文章失败，错误码：" + json.result);
                    }
                }
            });
        });

    });
</script>




